# AIå°è¯´åˆ›ä½œç³»ç»Ÿ - å‰ç«¯å¼€å‘æŒ‡å—

**è®¾è®¡æ–¹æ¡ˆ**: Material 3 Â· æç®€ã€Œçº¸å¢¨ã€é…è‰²
**æŠ€æœ¯æ ˆ**: Next.js 14 + TypeScript + Material UI v6
**åç«¯API**: http://localhost:8000/api

---

## ğŸ“¦ å¿«é€Ÿå¯åŠ¨

### 1. åˆå§‹åŒ–é¡¹ç›®ï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼‰

```bash
cd frontend
npm init -y
```

### 2. å®‰è£…ä¾èµ–

```bash
# æ ¸å¿ƒä¾èµ–
npm install next@latest react@latest react-dom@latest typescript @types/react @types/node

# Material UI v6
npm install @mui/material @mui/icons-material @emotion/react @emotion/styled

# çŠ¶æ€ç®¡ç†ä¸å·¥å…·
npm install axios swr zustand

# å¼€å‘ä¾èµ–
npm install --save-dev eslint eslint-config-next tailwindcss postcss autoprefixer
```

### 3. é…ç½®æ–‡ä»¶

åœ¨ `frontend` ç›®å½•åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š

#### `package.json` æ›´æ–°scripts:
```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

#### `tsconfig.json`:
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

#### `next.config.ts`:
```typescript
import type { NextConfig } from 'next';

const nextConfig: NextConfig = {
  reactStrictMode: true,
  transpilePackages: ['@mui/material', '@mui/icons-material'],
};

export default nextConfig;
```

---

## ğŸ¨ Material 3 ã€Œçº¸å¢¨ã€ä¸»é¢˜é…ç½®

### `theme/theme.ts`:
```typescript
'use client';

import { createTheme, PaletteMode } from '@mui/material/styles';

// çº¸å¢¨é…è‰²æ–¹æ¡ˆ
const lightPalette = {
  primary: {
    main: '#006C52',        // ä½é¥±å’Œç»¿
    contrastText: '#FFFFFF',
    container: '#D4F5E9',
  },
  secondary: {
    main: '#5F5F5F',        // ç°
    contrastText: '#FFFFFF',
  },
  background: {
    default: '#F9F7F2',     // çº¸ç™½
    paper: '#FFFFFF',
  },
  text: {
    primary: '#1D1C1A',     // å¢¨é»‘ (87% opacity)
    secondary: '#5F5F5F',
  },
  divider: '#C7C2B9',
  mode: 'light' as PaletteMode,
};

const darkPalette = {
  primary: {
    main: '#4EC9A1',        // é™ä½äº®åº¦çš„ç»¿
    contrastText: '#000000',
    container: '#004D3A',
  },
  secondary: {
    main: '#9E9E9E',
    contrastText: '#000000',
  },
  background: {
    default: '#1B1B1B',     // çº¯é»‘5%ä¸Šæµ®
    paper: '#242424',
  },
  text: {
    primary: '#E2E0DB',     // ç±³ç™½ (93% white)
    secondary: '#9E9E9E',
  },
  divider: '#494944',
  mode: 'dark' as PaletteMode,
};

export const createAppTheme = (mode: PaletteMode) => {
  const palette = mode === 'light' ? lightPalette : darkPalette;

  return createTheme({
    palette,
    typography: {
      fontFamily: [
        '-apple-system',
        'BlinkMacSystemFont',
        '"Segoe UI"',
        'Roboto',
        '"Noto Sans SC"',
        'sans-serif',
      ].join(','),
      // é’ˆå¯¹é˜…è¯»ä¼˜åŒ–çš„å­—ä½“å¤§å°
      body1: {
        fontSize: '16px',
        lineHeight: 1.75,
        letterSpacing: '0.02em',
      },
      h1: {
        fontSize: '2.5rem',
        fontWeight: 600,
      },
      h2: {
        fontSize: '2rem',
        fontWeight: 600,
      },
    },
    shape: {
      borderRadius: 8,
    },
    components: {
      MuiButton: {
        styleOverrides: {
          root: {
            textTransform: 'none',
            borderRadius: '8px',
          },
        },
      },
      MuiCard: {
        styleOverrides: {
          root: {
            boxShadow: mode === 'light'
              ? '0 2px 8px rgba(0,0,0,0.08)'
              : '0 2px 8px rgba(0,0,0,0.3)',
          },
        },
      },
    },
  });
};
```

---

## ğŸ“ æ¨èçš„ç›®å½•ç»“æ„

```
frontend/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx          # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx            # é¦–é¡µï¼ˆç™»å½•ï¼‰
â”‚   â”œâ”€â”€ register/
â”‚   â”‚   â””â”€â”€ page.tsx        # æ³¨å†Œé¡µ
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â””â”€â”€ page.tsx        # å°è¯´åˆ—è¡¨
â”‚   â”œâ”€â”€ novels/
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â”œâ”€â”€ page.tsx    # å°è¯´è¯¦æƒ…
â”‚   â”‚       â””â”€â”€ chapters/
â”‚   â”‚           â””â”€â”€ [cid]/
â”‚   â”‚               â””â”€â”€ page.tsx  # ç« èŠ‚ç¼–è¾‘
â”‚   â””â”€â”€ providers.tsx       # Context Providers
â”œâ”€â”€ components/             # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ Auth/
â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx
â”‚   â”‚   â””â”€â”€ RegisterForm.tsx
â”‚   â”œâ”€â”€ Novel/
â”‚   â”‚   â”œâ”€â”€ NovelCard.tsx
â”‚   â”‚   â””â”€â”€ NovelList.tsx
â”‚   â””â”€â”€ Chapter/
â”‚       â””â”€â”€ ChapterEditor.tsx
â”œâ”€â”€ lib/                    # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ api.ts              # API å®¢æˆ·ç«¯
â”‚   â””â”€â”€ auth.ts             # è®¤è¯å·¥å…·
â”œâ”€â”€ types/                  # TypeScript ç±»å‹
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ theme/                  # Material UI ä¸»é¢˜
â”‚   â””â”€â”€ theme.ts
â””â”€â”€ package.json
```

---

## ğŸ”‘ æ ¸å¿ƒä»£ç æ¡†æ¶

### 1. API å®¢æˆ·ç«¯ (`lib/api.ts`)

```typescript
const API_BASE = 'http://localhost:8000/api';

const getHeaders = () => {
  const token = localStorage.getItem('token');
  return {
    'Content-Type': 'application/json',
    ...(token && { 'Authorization': `Bearer ${token}` }),
  };
};

export const api = {
  // è®¤è¯
  async login(username: string, password: string) {
    const res = await fetch(`${API_BASE}/auth/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password }),
    });
    if (!res.ok) throw new Error('ç™»å½•å¤±è´¥');
    return res.json();
  },

  async register(username: string, email: string, password: string) {
    const res = await fetch(`${API_BASE}/auth/register`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, email, password }),
    });
    if (!res.ok) throw new Error('æ³¨å†Œå¤±è´¥');
    return res.json();
  },

  // å°è¯´
  async getNovels() {
    const res = await fetch(`${API_BASE}/novels/`, {
      headers: getHeaders(),
    });
    if (!res.ok) throw new Error('è·å–å¤±è´¥');
    return res.json();
  },

  async createNovel(data: any) {
    const res = await fetch(`${API_BASE}/novels/`, {
      method: 'POST',
      headers: getHeaders(),
      body: JSON.stringify(data),
    });
    if (!res.ok) throw new Error('åˆ›å»ºå¤±è´¥');
    return res.json();
  },

  // ç« èŠ‚
  async getChapters(novelId: number) {
    const res = await fetch(`${API_BASE}/novels/${novelId}/chapters`, {
      headers: getHeaders(),
    });
    if (!res.ok) throw new Error('è·å–å¤±è´¥');
    return res.json();
  },

  async createChapter(novelId: number, data: any) {
    const res = await fetch(`${API_BASE}/novels/${novelId}/chapters`, {
      method: 'POST',
      headers: getHeaders(),
      body: JSON.stringify(data),
    });
    if (!res.ok) throw new Error('åˆ›å»ºå¤±è´¥');
    return res.json();
  },
};
```

### 2. æ ¹å¸ƒå±€ (`app/layout.tsx`)

```typescript
'use client';

import { ThemeProvider } from '@mui/material/styles';
import CssBaseline from '@mui/material/CssBaseline';
import { createAppTheme } from '@/theme/theme';
import { useState, useMemo } from 'react';

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const [mode, setMode] = useState<'light' | 'dark'>('light');
  const theme = useMemo(() => createAppTheme(mode), [mode]);

  return (
    <html lang="zh-CN">
      <body>
        <ThemeProvider theme={theme}>
          <CssBaseline />
          {children}
        </ThemeProvider>
      </body>
    </html>
  );
}
```

### 3. ç™»å½•é¡µé¢ (`app/page.tsx`)

```typescript
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import {
  Container,
  Box,
  TextField,
  Button,
  Typography,
  Card,
  CardContent,
  Alert,
} from '@mui/material';
import { api } from '@/lib/api';

export default function LoginPage() {
  const router = useRouter();
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    try {
      const data = await api.login(username, password);
      localStorage.setItem('token', data.access_token);
      router.push('/dashboard');
    } catch (err) {
      setError('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯');
    }
  };

  return (
    <Container maxWidth="sm">
      <Box sx={{ mt: 8, display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
        <Typography variant="h4" component="h1" gutterBottom>
          AIå°è¯´åˆ›ä½œç³»ç»Ÿ
        </Typography>
        <Card sx={{ mt: 3, width: '100%' }}>
          <CardContent>
            <form onSubmit={handleLogin}>
              {error && <Alert severity="error" sx={{ mb: 2 }}>{error}</Alert>}
              <TextField
                fullWidth
                label="ç”¨æˆ·å"
                value={username}
                onChange={(e) => setUsername(e.target.value)}
                margin="normal"
                required
              />
              <TextField
                fullWidth
                label="å¯†ç "
                type="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                margin="normal"
                required
              />
              <Button
                fullWidth
                variant="contained"
                type="submit"
                sx={{ mt: 2 }}
              >
                ç™»å½•
              </Button>
              <Button
                fullWidth
                variant="text"
                onClick={() => router.push('/register')}
                sx={{ mt: 1 }}
              >
                æ³¨å†Œè´¦å·
              </Button>
            </form>
          </CardContent>
        </Card>
      </Box>
    </Container>
  );
}
```

### 4. å°è¯´åˆ—è¡¨é¡µ (`app/dashboard/page.tsx`)

```typescript
'use client';

import { useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';
import {
  Container,
  Box,
  Typography,
  Button,
  Grid,
  Card,
  CardContent,
  CardActions,
} from '@mui/material';
import AddIcon from '@mui/icons-material/Add';
import { api } from '@/lib/api';

export default function DashboardPage() {
  const router = useRouter();
  const [novels, setNovels] = useState([]);

  useEffect(() => {
    loadNovels();
  }, []);

  const loadNovels = async () => {
    try {
      const data = await api.getNovels();
      setNovels(data);
    } catch (err) {
      router.push('/');
    }
  };

  return (
    <Container maxWidth="lg">
      <Box sx={{ mt: 4, mb: 4 }}>
        <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 3 }}>
          <Typography variant="h4">æˆ‘çš„å°è¯´</Typography>
          <Button
            variant="contained"
            startIcon={<AddIcon />}
            onClick={() => {/* æ‰“å¼€åˆ›å»ºå¯¹è¯æ¡† */}}
          >
            æ–°å»ºå°è¯´
          </Button>
        </Box>
        <Grid container spacing={3}>
          {novels.map((novel: any) => (
            <Grid item xs={12} sm={6} md={4} key={novel.id}>
              <Card>
                <CardContent>
                  <Typography variant="h6">{novel.title}</Typography>
                  <Typography variant="body2" color="text.secondary">
                    {novel.genre}
                  </Typography>
                  <Typography variant="body2" sx={{ mt: 1 }}>
                    {novel.description}
                  </Typography>
                </CardContent>
                <CardActions>
                  <Button size="small" onClick={() => router.push(`/novels/${novel.id}`)}>
                    æŸ¥çœ‹è¯¦æƒ…
                  </Button>
                </CardActions>
              </Card>
            </Grid>
          ))}
        </Grid>
      </Box>
    </Container>
  );
}
```

---

## ğŸš€ å¼€å‘æµç¨‹

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
cd frontend
npm run dev
```

è®¿é—®: http://localhost:3000

### å¼€å‘é¡ºåºå»ºè®®

1. **Week 1**:
   - âœ… é…ç½®é¡¹ç›®å’Œä¸»é¢˜
   - âœ… å®ç°ç™»å½•/æ³¨å†Œé¡µé¢
   - âœ… å®ç°Tokenç®¡ç†

2. **Week 2**:
   - å®ç°å°è¯´åˆ—è¡¨é¡µ
   - å®ç°å°è¯´åˆ›å»º/ç¼–è¾‘è¡¨å•

3. **Week 3**:
   - å®ç°ç« èŠ‚åˆ—è¡¨
   - å®ç°ç« èŠ‚ç¼–è¾‘å™¨ï¼ˆMarkdownï¼‰

4. **Week 4**:
   - UIä¼˜åŒ–
   - å“åº”å¼é€‚é…
   - é”™è¯¯å¤„ç†å®Œå–„

---

## ğŸ“š å‚è€ƒèµ„æ–™

- **Material UIæ–‡æ¡£**: https://mui.com/material-ui/
- **Next.jsæ–‡æ¡£**: https://nextjs.org/docs
- **åç«¯APIæ–‡æ¡£**: http://localhost:8000/docs
- **APIå¯¹æ¥æ–‡æ¡£**: è§é¡¹ç›®æ ¹ç›®å½• `APIå¯¹æ¥æ–‡æ¡£.md`

---

## ğŸ’¡ å¼€å‘æç¤º

1. **ä¸»é¢˜åˆ‡æ¢**: ä½¿ç”¨ `localStorage` ä¿å­˜ç”¨æˆ·çš„ä¸»é¢˜åå¥½
2. **Tokenåˆ·æ–°**: å®ç°Tokenè¿‡æœŸè‡ªåŠ¨åˆ·æ–°æœºåˆ¶
3. **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯æç¤ºç»„ä»¶
4. **åŠ è½½çŠ¶æ€**: ä½¿ç”¨ Material UI çš„ Skeleton ç»„ä»¶
5. **å“åº”å¼**: ç§»åŠ¨ç«¯ä¼˜å…ˆçš„è®¾è®¡æ€è·¯

---

**å‡†å¤‡å®Œæˆï¼ç°åœ¨å¯ä»¥å¼€å§‹å‰ç«¯å¼€å‘äº†ã€‚** ğŸ¨
